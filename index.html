---
---
{% comment %}
Empty frontmatter so that jekyll knows that this HTML file needs processing.
See: https://jekyllrb.com/docs/front-matter/
{% endcomment %}

<!DOCTYPE html>
<html lang="de">
  <head>
    <title>War-o-Mat</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Der Tabletoptroll präsentiert: Den War-o-Mat! Beantworte die Fragen und finde heraus, welche Warhammer Age of Sigmar Fraktion am besten zu deiner Spielweise passt.">

    <link href="assets/css/fonts/fontawsome/css/all.min.css" rel="stylesheet" />

    <style>
      @import url('assets/css/reset.css') layer(reset);
      @import url('assets/css/fonts.css');

      @import url('assets/css/tokens/motion.css') layer(tokens);
      @import url('assets/css/tokens/colors.css') layer(tokens);
      @import url('assets/css/tokens/typography.css') layer(tokens);

      @import url('assets/css/layout.css') layer(layout);
      @import url('assets/css/header.css') layer(layout);
      @import url('assets/css/footer.css') layer(layout);

      @import url('assets/css/components/stacked-list.css') layer(components);
      @import url('assets/css/components/jumpnav.css') layer(components);
      @import url('assets/css/components/question.css') layer(components);
      @import url('assets/css/components/button.css') layer(components);

      :root {
        --primary-hue: 90deg;
        /* Gold */
        /* 123deg ~ TableTopTroll grün */

        accent-color: var(--color-primary);
        scrollbar-color: var(--color-primary) transparent;
      }

      main {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(min(100%, 600px), 1fr));
        grid-auto-rows: min-content;
        gap: 40px;
        justify-items: center;
        justify-self: center;
      }

      #war-o-mat {
        display: grid;
        gap: inherit;
      }

      #result h2 {
        margin-block-end: 1em;
      }

      #result ol {
        display: grid;
        gap: 2em;

        & > * {
          width: min(55ch, 100%);
        }

         & > :nth-child(1) {
          justify-self: center;
        }

         & > :nth-child(2) {
          justify-self: start;
        }

         & > :nth-child(3) {
          justify-self: end;
        }
      }

      .hidden {
        display: none;
      }


    </style>
    <script>
            const ATTRIBUTE_FACTION_VALUE = {
                "casting": {
                    "__1": "Zauber wirken",
                    "__2": "Götter anrufen",
                    "Nighthaunt": -1,
                    "Ossiarch": -1,
                    "FEC": -1,
                    "SBTG": -1,
                    "Ogor": -1,
                    "SoB": 0,
                    "Orruks": -1,
                    "Gitz": -2,
                    "Khorne": 2,
                    "Nurgle": -1,
                    "Slanesh": 0,
                    "Tzeentch": -2,
                    "Skaven": -1,
                    "STD": -1,
                    "CoS": 0,
                    "Sylvaneth": -2,
                    "Fyreslayers": 2,
                    "Idoneth": -1,
                    "DoK": -2,
                    "Lumineth": -2,
                    "Seraphon": -2,
                    "Stormcast": -2,
                    "Kharadron": 0
                },
                "kampfstil": {
                    "__1": "Nahkampflastig",
                    "__2": "Fernkampflastig",
                    "Nighthaunt": -1,
                    "Ossiarch": -1,
                    "FEC": -2,
                    "SBTG": -1,
                    "Ogor": -1,
                    "SoB": -2,
                    "Orruks": -2,
                    "Gitz": 0,
                    "Khorne": -2,
                    "Nurgle": -1,
                    "Slanesh": 1,
                    "Tzeentch": 1,
                    "Skaven": 0,
                    "STD": 0,
                    "CoS": 1,
                    "Sylvaneth": -1,
                    "Fyreslayers": -2,
                    "Idoneth": 1,
                    "DoK": -2,
                    "Lumineth": 0,
                    "Seraphon": -2,
                    "Stormcast": -2,
                    "Kharadron": 2
                },
                "temperament": {
                    "__1": "Kalt / Berechnend",
                    "__2": "Heißblütig / Wild",
                    "Nighthaunt": 0,
                    "Ossiarch": -1,
                    "FEC": 2,
                    "SBTG": -1,
                    "Ogor": 2,
                    "SoB": 2,
                    "Orruks": 2,
                    "Gitz": 0,
                    "Khorne": 2,
                    "Nurgle": 0,
                    "Slanesh": -1,
                    "Tzeentch": -1,
                    "Skaven": 0,
                    "STD": 0,
                    "CoS": -1,
                    "Sylvaneth": -1,
                    "Fyreslayers": 2,
                    "Idoneth": -1,
                    "DoK": 2,
                    "Lumineth": -1,
                    "Seraphon": -2,
                    "Stormcast": -2,
                    "Kharadron": -1
                },
                "aufstellung": {
                    "__1": "Viele Spezialisten",
                    "__2": "Viele Generalisten",
                    "Nighthaunt": 0,
                    "Ossiarch": -1,
                    "FEC": 0,
                    "SBTG": -1,
                    "Ogor": 0,
                    "SoB": 2,
                    "Orruks": 1,
                    "Gitz": -1,
                    "Khorne": 1,
                    "Nurgle": 0,
                    "Slanesh": -1,
                    "Tzeentch": -1,
                    "Skaven": -2,
                    "STD": -1,
                    "CoS": 0,
                    "Sylvaneth": 0,
                    "Fyreslayers": 1,
                    "Idoneth": 1,
                    "DoK": 1,
                    "Lumineth": -1,
                    "Seraphon": -1,
                    "Stormcast": -2,
                    "Kharadron": 1
                },
                "spielmotivation": {
                    "__1": "Gewinnorientiert",
                    "__2": "Spaßorientiert",
                    "Nighthaunt": 0,
                    "Ossiarch": -1,
                    "FEC": 0,
                    "SBTG": 0,
                    "Ogor": 1,
                    "SoB": 2,
                    "Orruks": 2,
                    "Gitz": 2,
                    "Khorne": 2,
                    "Nurgle": -1,
                    "Slanesh": -1,
                    "Tzeentch": -1,
                    "Skaven": 2,
                    "STD": -1,
                    "CoS": 0,
                    "Sylvaneth": -1,
                    "Fyreslayers": 1,
                    "Idoneth": -1,
                    "DoK": 1,
                    "Lumineth": -1,
                    "Seraphon": -1,
                    "Stormcast": -2,
                    "Kharadron": 0
                },
                "truppengroesse": {
                    "__1": "Horde / viele Modelle",
                    "__2": "Elite / wenig Modelle",
                    "Nighthaunt": -1,
                    "Ossiarch": -1,
                    "FEC": 1,
                    "SBTG": -1,
                    "Ogor": 1,
                    "SoB": 2,
                    "Orruks": -2,
                    "Gitz": -1,
                    "Khorne": 1,
                    "Nurgle": 1,
                    "Slanesh": -1,
                    "Tzeentch": 0,
                    "Skaven": -2,
                    "STD": 1,
                    "CoS": 0,
                    "Sylvaneth": -1,
                    "Fyreslayers": -1,
                    "Idoneth": 0,
                    "DoK": 0,
                    "Lumineth": -1,
                    "Seraphon": -1,
                    "Stormcast": -2,
                    "Kharadron": 1
                },
                "beweglichkeit": {
                    "__1": "Schwerfällig & Zäh",
                    "__2": "Flink & Schwach",
                    "Nighthaunt": 1,
                    "Ossiarch": -1,
                    "FEC": 1,
                    "SBTG": 1,
                    "Ogor": -2,
                    "SoB": -2,
                    "Orruks": -1,
                    "Gitz": 2,
                    "Khorne": -1,
                    "Nurgle": -1,
                    "Slanesh": 2,
                    "Tzeentch": 1,
                    "Skaven": 2,
                    "STD": -1,
                    "CoS": 1,
                    "Sylvaneth": 0,
                    "Fyreslayers": -1,
                    "Idoneth": 2,
                    "DoK": 2,
                    "Lumineth": 2,
                    "Seraphon": -1,
                    "Stormcast": -2,
                    "Kharadron": 1
                },
                "strategie": {
                    "__1": "Heimlich / Hinterrücks",
                    "__2": "Direkt / Konfrontativ",
                    "Nighthaunt": -1,
                    "Ossiarch": 1,
                    "FEC": 1,
                    "SBTG": -1,
                    "Ogor": 2,
                    "SoB": 2,
                    "Orruks": 2,
                    "Gitz": -2,
                    "Khorne": 2,
                    "Nurgle": 1,
                    "Slanesh": -2,
                    "Tzeentch": -1,
                    "Skaven": -2,
                    "STD": 1,
                    "CoS": 1,
                    "Sylvaneth": -1,
                    "Fyreslayers": 2,
                    "Idoneth": -1,
                    "DoK": 2,
                    "Lumineth": -2,
                    "Seraphon": 1,
                    "Stormcast": 2,
                    "Kharadron": -1
                },
                "technologie": {
                    "__1": "Technologisch fortschrittlich",
                    "__2": "Klassische Kriegsführung",
                    "Nighthaunt": 2,
                    "Ossiarch": 1,
                    "FEC": 1,
                    "SBTG": 0,
                    "Ogor": 2,
                    "SoB": 2,
                    "Orruks": 2,
                    "Gitz": 0,
                    "Khorne": 1,
                    "Nurgle": 1,
                    "Slanesh": 1,
                    "Tzeentch": 1,
                    "Skaven": -2,
                    "STD": 1,
                    "CoS": -1,
                    "Sylvaneth": 2,
                    "Fyreslayers": 2,
                    "Idoneth": 1,
                    "DoK": 2,
                    "Lumineth": -1,
                    "Seraphon": 1,
                    "Stormcast": 2,
                    "Kharadron": -2
                },
                "modelle": {
                    "__1": "Große Auswahl an Modellen",
                    "__2": "Geringe Auswahl an Modellen",
                    "Nighthaunt": -1,
                    "Ossiarch": 0,
                    "FEC": 0,
                    "SBTG": -1,
                    "Ogor": 1,
                    "SoB": 2,
                    "Orruks": -1,
                    "Gitz": -1,
                    "Khorne": 0,
                    "Nurgle": 1,
                    "Slanesh": -2,
                    "Tzeentch": 0,
                    "Skaven": -2,
                    "STD": -1,
                    "CoS": -1,
                    "Sylvaneth": 0,
                    "Fyreslayers": 2,
                    "Idoneth": 0,
                    "DoK": 1,
                    "Lumineth": -1,
                    "Seraphon": 0,
                    "Stormcast": -2,
                    "Kharadron": 1
                },
                "helden": {
                    "__1": "Viele (namenhafte) Helden",
                    "__2": "Wenig (namenhafte) Helden",
                    "Nighthaunt": -1,
                    "Ossiarch": 0,
                    "FEC": -1,
                    "SBTG": -2,
                    "Ogor": 1,
                    "SoB": 2,
                    "Orruks": 0,
                    "Gitz": 0,
                    "Khorne": 1,
                    "Nurgle": 0,
                    "Slanesh": -2,
                    "Tzeentch": 0,
                    "Skaven": -2,
                    "STD": -1,
                    "CoS": -1,
                    "Sylvaneth": 0,
                    "Fyreslayers": 2,
                    "Idoneth": 1,
                    "DoK": 1,
                    "Lumineth": -1,
                    "Seraphon": 0,
                    "Stormcast": -2,
                    "Kharadron": 1
                }
            }
    </script>
    <script>
            function revealResult() {
                document.getElementById('show-results-button').remove();
                document.getElementById('result').classList.remove('hidden');
            }

            function getActiveQuestionNo() {
                const active_question = document.querySelector('#question-list > .active');
                return !active_question ? 0 : [...active_question.parentNode.children].indexOf(active_question);
            }

            function syncJumpNav(){
                const questionList = document.getElementById('question-list');
                const jumpNav = document.getElementById('jumpnav');

                // Set jumpNav item to .done if question input is :checked
                questionList.querySelectorAll('li').forEach((listItem, i) => {
                    const checked = listItem.querySelector('input:checked');
                    const active = listItem.classList.contains('active');
                    const jumpNavItem = jumpNav.children[i];
                    if (checked) {
                        jumpNavItem.classList.add('done');
                    } else {
                        jumpNavItem.classList.remove('done');
                    }
                    if (active) {
                        jumpNavItem.classList.add('active');
                    } else {
                        jumpNavItem.classList.remove('active');
                    }
                });
            }

            function gotoQuestionNo(questionNo) {
                const question_list = document.getElementById('question-list');
                const active_questions = question_list.querySelectorAll('.active');
                active_questions.forEach((question) => question.classList.remove('active'));
                active_question = question_list.children[questionNo]
                active_question.classList.add('active');

                syncJumpNav();
            }

            function gotoNext() {
                const current = getActiveQuestionNo();
                if (current === undefined) gotoQuestionNo(0);

                const questions = document.getElementById('question-list').children;
                if (current < questions.length - 1) {
                    gotoQuestionNo(current + 1);
                } else {
                    revealResult();
                }
            }

            function unlockSkipButton() {
                document.getElementById('show-results-button').classList.remove('hidden');
            }

            function complete(question) {
                gotoNext();
                unlockSkipButton();
                syncJumpNav();
            }


            const euclideanDistance = (a, b) => Math.hypot(...Object.keys(a).map(k => b[k] - a[k]));
            const euclideanQuadraticDistance = (a, b) => Object.keys(a).reduce((acc, k) => acc + (b[k] - a[k]) ** 2, 0);

            document.addEventListener('DOMContentLoaded', () => {
                const form = document.getElementById('war-o-mat');
                const questionList = document.getElementById('question-list');
                const jumpNav = document.getElementById('jumpnav');

                questionList.querySelectorAll('input[type="radio"]').forEach((radio) => {
                    radio.addEventListener('change', (event) => {
                        complete(event.target.closest('.question'));
                    });
                });
      

                form.addEventListener('reset', (event) => {
                    setTimeout(function() {
                        gotoQuestionNo(0);
                        document.getElementById('show-results-button').classList.add('hidden');
                        syncJumpNav();
                     }, 10);
                });

                form.addEventListener('input', (event) => {
                    const formData = Object.fromEntries(new FormData(form).entries());
                    console.log(formData);

                    let vector = [];
                    let faction_vectors = {};

                    for (let [id, value] of Object.entries(formData)) {
                        if (id.startsWith('double-')) {
                            id = id.replace('double-', '');
                            value = formData[id];
                        }

                        const numValue = parseInt(value);
                        if (isNaN(numValue)) continue;

                        vector.push(numValue);
                        vector_for_faction = {};

                        for (const [faction, faction_value] of Object.entries(ATTRIBUTE_FACTION_VALUE[id])) {
                            if (faction.startsWith('__')) continue;
                            if (!faction_vectors[faction]) {
                                faction_vectors[faction] = [];
                            }
                            faction_vectors[faction].push(faction_value);
                        }
                    }

                    // map over values from faction_vectors and calculate the distance to the vector
                    const distances = Object.entries(faction_vectors).map(([faction, faction_vector]) => {
                        return {
                            faction,
                            euclidean: euclideanQuadraticDistance(vector, faction_vector)
                        }
                    }).sort((a, b) => a.euclidean - b.euclidean);

                    console.log("Vector: ", vector);

                    const resultList = document.getElementById("result-list");
                    resultList.replaceChildren(
                        ...distances.slice(0, 3).map(({faction, euclidean}) => {
                            const template = document.getElementById(faction);
                            return template.content.cloneNode(true);
                        })
                    );
                });
            });
    </script>
  </head>

  <body>
    <div id="header">
      <div class="wrap">
        <a href="index.html"><img src="assets/images/logo.png" alt="Tabletoptroll Logo"></a> 
        <div class="header-nav" style="height: 48px;">
          <a href="https://www.instagram.com/tabletoptroll/" target="_blank" class="social">
            <svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><path d="M295.42,6c-53.2,2.51-89.53,11-121.29,23.48-32.87,12.81-60.73,30-88.45,57.82S40.89,143,28.17,175.92c-12.31,31.83-20.65,68.19-23,121.42S2.3,367.68,2.56,503.46,3.42,656.26,6,709.6c2.54,53.19,11,89.51,23.48,121.28,12.83,32.87,30,60.72,57.83,88.45S143,964.09,176,976.83c31.8,12.29,68.17,20.67,121.39,23s70.35,2.87,206.09,2.61,152.83-.86,206.16-3.39S799.1,988,830.88,975.58c32.87-12.86,60.74-30,88.45-57.84S964.1,862,976.81,829.06c12.32-31.8,20.69-68.17,23-121.35,2.33-53.37,2.88-70.41,2.62-206.17s-.87-152.78-3.4-206.1-11-89.53-23.47-121.32c-12.85-32.87-30-60.7-57.82-88.45S862,40.87,829.07,28.19c-31.82-12.31-68.17-20.7-121.39-23S637.33,2.3,501.54,2.56,348.75,3.4,295.42,6m5.84,903.88c-48.75-2.12-75.22-10.22-92.86-17-23.36-9-40-19.88-57.58-37.29s-28.38-34.11-37.5-57.42c-6.85-17.64-15.1-44.08-17.38-92.83-2.48-52.69-3-68.51-3.29-202s.22-149.29,2.53-202c2.08-48.71,10.23-75.21,17-92.84,9-23.39,19.84-40,37.29-57.57s34.1-28.39,57.43-37.51c17.62-6.88,44.06-15.06,92.79-17.38,52.73-2.5,68.53-3,202-3.29s149.31.21,202.06,2.53c48.71,2.12,75.22,10.19,92.83,17,23.37,9,40,19.81,57.57,37.29s28.4,34.07,37.52,57.45c6.89,17.57,15.07,44,17.37,92.76,2.51,52.73,3.08,68.54,3.32,202s-.23,149.31-2.54,202c-2.13,48.75-10.21,75.23-17,92.89-9,23.35-19.85,40-37.31,57.56s-34.09,28.38-57.43,37.5c-17.6,6.87-44.07,15.07-92.76,17.39-52.73,2.48-68.53,3-202.05,3.29s-149.27-.25-202-2.53m407.6-674.61a60,60,0,1,0,59.88-60.1,60,60,0,0,0-59.88,60.1M245.77,503c.28,141.8,115.44,256.49,257.21,256.22S759.52,643.8,759.25,502,643.79,245.48,502,245.76,245.5,361.22,245.77,503m90.06-.18a166.67,166.67,0,1,1,167,166.34,166.65,166.65,0,0,1-167-166.34" transform="translate(-2.5 -2.5)"/></svg>
          </a>
          <a href="https://www.youtube.com/@tabletoptroll" target="_blank" class="social">
            <svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet" viewBox="0 0 28.57 20">
              <path fill="currentColor" fill-rule="nonzero" d="M27.97 3.12A3.58 3.58 0 0 0 25.44.6C23.22 0 14.28 0 14.28 0S5.35 0 3.12.6A3.58 3.58 0 0 0 .6 3.12C0 5.35 0 10 0 10s0 4.65.6 6.88a3.58 3.58 0 0 0 2.52 2.52c2.23.6 11.17.6 11.17.6s8.93 0 11.16-.6a3.58 3.58 0 0 0 2.52-2.52c.6-2.23.6-6.88.6-6.88s0-4.65-.6-6.88ZM11.43 5.71 18.85 10l-7.42 4.28Z"/>
            </svg>
          </a>
        </div>
      </div>
    </div>

    <main id="content">
      <div id="left">
        <div class="intro">
          <h1>War-o-Mat</h1>
          <p>
            Der Tabletoptroll präsentiert: Den War-o-Mat! 
            Beantworte die Fragen und finde heraus, welche Warhammer Age of Sigmar Fraktion am besten zu deiner Spielweise passt. 
          </p>
        </div>
        <form id="war-o-mat">
          <div class="wrap">
            <ol id="question-list" class="stacked-list">
              {% for attribute in site.data.csv.attributes %}
                <li
                  id="question-{{ forloop.index }}"
                  {% if forloop.first %}
                  class="active"
                  {% endif %}>
                  {% include question.html question=attribute %}
                </li>
              {% endfor %}
            </ol>
            <nav style="display: flex; justify-content: space-between">
              <ol id="jumpnav">
                {% for attribute in site.data.csv.attributes %}
                  <li
                    {% if forloop.first %}
                    class="active"
                    {% endif %}>
                    <a aria-label="Frage {{ forloop.index }}" onclick="gotoQuestionNo({{ forloop.index0 }})">
                      <i class="fa-solid fa-check"></i>
                    </a>
                  </li>
                {% endfor %}
              </ol>
            </nav>
          </div>
          <div class="formbtn">
            <button
            id="show-results-button"
            class="button text hidden"
            onclick="event.preventDefault(); revealResult();"
            style="justify-self: center;">
            Zeig mir meine Fraktion jetzt!
            <i class="fa-solid fa-circle-arrow-right"></i>
          </button>
            <button
            class="icon-button"
            type="reset"
            aria-label="Zurücksetzen">
            <i class="fa-solid fa-arrow-rotate-left"></i>Antworten Zurücksetzen
          </button>
          </div>
        </form>
      </div>
      
      <div id="right">
        <div class="hidden" id="result">
          <h2>Für dich empfohlen</h2>
          <ol id="result-list"></ol>
        </div>
      </div>

    </main>

    
  {% comment %}
  Hier werden die Templates für die Fraktionen generiert.
{% endcomment %}

    <footer>
      <a class="link" href="https://www.winterrabe.net/">
        <img src="assets/images/logo-white.png" alt="Winterrabe Logo" style=" margin-bottom: 22px;" width="400px">
      </a>
      <a class="link" href="https://taschengelddieb.de/?affiliate=ttt">
        <img src="assets/images/shoplogo.png" alt="Taschengelddieb Logo" style="margin-bottom: 16px;" width="400px">
      </a>

      <a class="button text link" href="impressum.html">Impressum</a>
    </footer>

    {% for faction in site.data.csv.factions %}
      <template id="{{faction.id}}">
        <article>
          <h3>{{ faction.full_name }}</h3>
          <p style="margin-block-end: 1em;">{{ faction.description }}</p>
          <a class="button filled" href="{{faction.affiliate_link}}" target="_blank">Hier geht's zum Set!</a>
        </article>
      </template>
    {% endfor %}
  </body>
</html>